<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link style="width: 16px;" rel="icon" type="image/png" href="img/favicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diastema</title>
    
    <link rel="stylesheet" href="css/style.css">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <!-- MDB -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.0.0/mdb.min.css" rel="stylesheet"/>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.0.0/mdb.min.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <!-- JQuery -->
    <link rel="stylesheet" href="css/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
    <!-- Flowchart CSS and JS -->
	<link rel="stylesheet" href="css/jquery.flowchart.css">
	<script src="js/jquery.flowchart.js"></script>

    <style>
        .sidebar {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            z-index: 100;
            padding: 90px 0 0;
            box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
            z-index: 99;
        }

        @media (max-width: 767.98px) {
            .sidebar {
                top: 11.5rem;
                padding: 0;
            }
        }

        .navbar {
            box-shadow: inset 0 -1px 0 rgba(0, 0, 0, .1);
        }

        @media (min-width: 767.98px) {
            .navbar {
                top: 0;
                position: sticky;
                z-index: 999;
            }
        }

        .sidebar .nav-link {
            color: #333;
        }

        .sidebar .nav-link.active {
            color:#ca1515
        }
    </style>
</head>
<body>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light" style="padding: 20px 0 20px 0;">
        <div class="container-fluid" id="menu-login">
            <!-- <button class="navbar-toggler" type="button" data-mdb-toggle="collapse" data-mdb-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button> -->
            <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
                <a href="dashboard.html"><img src="img/logo.png" style="width: 200px;"></a>
            </div>
            <ul class="navbar-nav d-flex flex-row ms-auto">
                <!-- Avatar -->
                <li class="nav-item dropdown" id="avatar">
                    <a class="nav-link dropdown-toggle d-flex align-items-center" href="" id="navbarDropdownMenuLink" role="button" data-mdb-toggle="dropdown" aria-expanded="false">
                        <img src="img/user.png" class="rounded-circle" height="30" alt="" loading="lazy"/>
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" style="margin-left: -30px;">
                        <li><a class="dropdown-item" href="index.html">Logout</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- Tools -->
            <nav id="sidebar" class="col-md-2 col-lg-2 d-md-block bg-light sidebar tools">
                <div class="position-sticky pt-md-5">
                    <ul class="nav flex-column">
                        <h3 style="margin-bottom: 40px;padding:0 0 10px 10px;border-bottom: 1px solid #e2e2e2;width: 80%;">Tools</h3>
                        
                        <!-- Tool 1 -->
                        <div id="tool" class="flowchart-operator flowchart-default-operator draggable_operator" data-nb-inputs="0" data-nb-outputs="1" style="margin-bottom:25px;">
                            <div class="flowchart-operator-title ui-draggable-handle">Data Load</div>
                            <div class="flowchart-operator-inputs-outputs">
                                <div class="flowchart-operator-inputs"></div>
                                <div class="flowchart-operator-outputs">
                                    <div class="flowchart-operator-connector-set">
                                        <div class="flowchart-operator-connector">
                                            <div class="flowchart-operator-connector-label">
                                                Output 1
                                            </div>
                                            <div class="flowchart-operator-connector-arrow"></div>
                                            <div class="flowchart-operator-connector-small-arrow"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Tool 2 -->
                        <div id="tool" class="flowchart-operator flowchart-default-operator draggable_operator" data-nb-inputs="2" data-nb-outputs="1" style="margin-bottom:25px;">
                            <div class="flowchart-operator-title ui-draggable-handle">Tool-X</div>
                            <div class="flowchart-operator-inputs-outputs">
                                <div class="flowchart-operator-inputs">
                                    <div class="flowchart-operator-connector-set">
                                        <div class="flowchart-operator-connector">
                                            <div class="flowchart-operator-connector-label">Input 1</div>
                                            <div class="flowchart-operator-connector-arrow"></div>
                                            <div class="flowchart-operator-connector-small-arrow"></div>
                                        </div>
                                    </div>
                                    <div class="flowchart-operator-connector-set">
                                        <div class="flowchart-operator-connector">
                                            <div class="flowchart-operator-connector-label">Input 2</div>
                                            <div class="flowchart-operator-connector-arrow"></div>
                                            <div class="flowchart-operator-connector-small-arrow"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flowchart-operator-outputs">
                                    <div class="flowchart-operator-connector-set">
                                        <div class="flowchart-operator-connector">
                                            <div class="flowchart-operator-connector-label">Output 1</div>
                                            <div class="flowchart-operator-connector-arrow"></div>
                                            <div class="flowchart-operator-connector-small-arrow"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Tool 3 -->
                        <div id="tool" class="flowchart-operator flowchart-default-operator draggable_operator" data-nb-inputs="1" data-nb-outputs="0" style="margin-bottom:25px;">
                            <div class="flowchart-operator-title ui-draggable-handle">Vis</div>
                            <div class="flowchart-operator-inputs-outputs">
                                <div class="flowchart-operator-inputs">
                                    <div class="flowchart-operator-connector-set">
                                        <div class="flowchart-operator-connector">
                                            <div class="flowchart-operator-connector-label">Input 1</div>
                                            <div class="flowchart-operator-connector-arrow"></div>
                                            <div class="flowchart-operator-connector-small-arrow"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="flowchart-operator-outputs"></div>
                            </div>
                        </div>

                        <button type="button" class="delete_selected_button btn btn-primary">Delete selected</button>
                        <div id="operator_properties" style="display: block;margin-bottom: 20px;">
                            <label for="operator_title">Node's title: </label><br>
                            <input style="width: 12vw;" id="operator_title" type="text">
                        </div>
                        <div id="link_properties" style="display: block;">
                            <label for="link_color">Link's color: </label><input id="link_color" type="color">
                        </div>

                        <div>
                            <textarea style="width: 12vw;height: 20vh;" id="flowchart_data"></textarea>
                        </div>

                    </ul>
                </div>
            </nav>

            <!-- Canvas -->
            <div id="dropzone" class="col-md-10 ml-sm-auto col-lg-10 px-md-4 py-4" style="position:absolute;bottom: 0px;right: 0px;top: 106px;">
                
                <div class="row" id="canvas" style="border-bottom: 1px solid #e2e2e2;">
                    <div class="col-md-7" >
                        <h3>Canvas</h3>
                    </div>
                    <div class="col-md-5">
                        <div style="position:absolute;display: flex;right: 0px;">
                            <div class="inline">
                                <button type="button" class="get_data btn btn-primary" id="get_data" onclick="onDownload()">Export Data</button>
                            </div>
                            <div class="inline">
                                <button type="button" class="set_data btn btn-primary" id="set_data">Load data</button>
                            </div>
                            <div class="inline">
                                <button type="button" class="btn btn-primary" id="save_local">Save to local storage</button>
                            </div>
                            <div class="inline">
                                <button type="button" class="btn btn-primary" id="load_local">Load from local storage</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="canvas" id="flowchartworkspace" style="position: absolute;bottom: 70px;top: 80px;right: 0px;left: 0px;">

                </div>
                
                <footer style="position: absolute;bottom: 40px;width: 96%;text-align:center;">
                    <span>Diastema © 2021 - All rights reserved</span>
                </footer>

            </div>

            <!-- Drop json file functionality -->
            <script>
                function handleFileSelect(evt) {
                evt.stopPropagation();
                evt.preventDefault();

                var files = evt.dataTransfer.files; // FileList object.
                var reader = new FileReader();  
                reader.onload = function(event) {            
                    document.getElementById('flowchart_data').value = event.target.result;
                    var $flowchart = $('#flowchartworkspace');
                    var data = JSON.parse($('#flowchart_data').val());
				    $flowchart.flowchart('setData', data);
                }        
                reader.readAsText(files[0],"UTF-8");
                }

                function handleDragOver(evt) {
                    evt.stopPropagation();
                    evt.preventDefault();
                    evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
                }

                // Setup the dnd listeners.
                var dropZone = document.getElementById('dropzone');
                dropZone.addEventListener('dragover', handleDragOver, false);
                dropZone.addEventListener('drop', handleFileSelect, false);
            </script>

        </div>
    </div>
    
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js" integrity="sha384-oesi62hOLfzrys4LxRF63OJCXdXDipiYWBnvTl9Y9/TRlw5xlKIEHpNyvvDShgf/" crossorigin="anonymous"></script>
    <script src="js/app.js"></script>
</body>
</html>